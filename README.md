# Battle Service API

Простой сервис на FastAPI для проведения битв между участниками.

## Описание

Сервис предоставляет два основных эндпоинта:
1. `POST /battle/start` - создает новую битву между двумя участниками
2. `GET /battle/{battle_id}` - возвращает результат битвы по ID

Победитель определяется случайно с учетом характеристики `power` каждого участника. Вероятность победы пропорциональна силе участника.

## Архитектура

```
├── main.py          # Точка входа, запуск uvicorn и регистрация эндпоинтов
├── schemas.py       # Pydantic схемы для валидации данных
├── game_logic.py    # Бизнес-логика игры (сервис битв)
├── endpoints.py     # API эндпоинты (контроллеры)
├── requirements.txt # Зависимости проекта
└── README.md        # Документация
```

### Компоненты:

- **schemas.py** - Pydantic модели для валидации входящих и исходящих данных
- **game_logic.py** - Бизнес-логика: класс `BattleService` для управления битвами
- **endpoints.py** - FastAPI роутер с эндпоинтами
- **main.py** - Конфигурация приложения и запуск сервера

## Установка и запуск

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск сервера

```bash
python main.py
```

Или с помощью uvicorn:

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

Сервер будет доступен по адресу: http://0.0.0.0:8000

### 3. Документация API

После запуска сервера доступна автоматическая документация:
- Swagger UI: http://0.0.0.0:8000/docs
- ReDoc: http://0.0.0.0:8000/redoc

## Использование API

### Создание битвы

```bash
curl -X POST "http://localhost:8000/battle/start" \
     -H "Content-Type: application/json" \
     -d '{
       "participant1": {
         "name": "Геракл",
         "power": 85
       },
       "participant2": {
         "name": "Зевс",
         "power": 95
       }
     }'
```

Ответ:
```json
{
  "battle_id": "550e8400-e29b-41d4-a716-446655440000"
}
```

### Получение результата битвы

```bash
curl "http://localhost:8000/battle/550e8400-e29b-41d4-a716-446655440000"
```

Ответ:
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "participant1": {
    "name": "Геракл",
    "power": 85
  },
  "participant2": {
    "name": "Зевс",
    "power": 95
  },
  "winner": "Зевс",
  "winner_power": 95,
  "created_at": "2024-01-15T10:30:00",
  "completed": true
}
```

## Особенности реализации

- **Чистая архитектура**: Разделение ответственности между слоями
- **Валидация данных**: Строгая валидация с помощью Pydantic (имя 1-100 символов, сила 0-1000)
- **Алгоритм определения победителя**: Вероятность победы пропорциональна силе участника
- **Обработка ошибок**: Корректная обработка несуществующих битв (404) и неверных данных (422)
- **Документация**: Автоматическая генерация OpenAPI документации
- **Хранение данных**: Все данные хранятся в памяти (словарь Python)

## API Endpoints

| Метод | Путь            | Описание |
|-------|-----------------|----------|
| GET | `battle/`       | Информация о сервисе |
| POST | `/battle/start` | Создание новой битвы |
| GET | `/battle/{id}`  | Получение результата битвы |

## Валидация данных

- **name**: строка от 1 до 100 символов
- **power**: целое число от 0 до 1000
- Все поля обязательны 